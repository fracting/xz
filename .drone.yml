debug: true

build:
  image: fracting/msys32-docker:local
  shell: ALLOC_XVFB=true /usr/bin/msys2-shell
  commands:
    - uname -a
    - ls -lh
    - pwd
    - echo dummy
    - echo $DRONE_BUILD_DIR
    - echo $CI
    - echo $DRONE
    - pacman -S --noconfirm --needed libiconv-devel gettext-devel
    - ./autogen.sh
    - ./configure
    - make
    - make check

notify:
  irc:
    prefix: build
    nick: xz
    channel: wine-zh
    server:
      host: chat.freenode.net
      port: 6667

